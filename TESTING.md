# TESTING
## Table of Contents

[VALIDATION](#validation)
 - [Python](#python)
 - [JavaScript](#javascript)
 - [CSS](#css)
 - [HTML](#html)
 - [Lighthouse](#lighthouse)
 - [Console Message](console-message)

[MANUAL TESTING](#manual-testing)
- [Global](#global-1)
    - [Navigation](#navigation)
        - [Navigation bar](#navigation-bar)
        - [Other links](#other-links)
        - [Forms](#forms)
    - [Logged in status](#logged-in-status)
    - [Authentication](#authentication)
- [User Stories and CRUD](#user-stories-and-crud)
    - [General stories](#general-stories)
    - [Full front-end CRUD](#full-front-end-crud)





## Validation
### Python
![Flake8](https://flake8.pycqa.org/en/latest/index.html) was used to validate all Python files. Screenshots of the results follow. I did initially encounter a number of errors in line spacing and indentation, which have been fixed. The only remaining errors, as shown below, are 
- E501 errors (line too long), all for files that were generated by Django, either from the outset or as migrations, and which I have not touched; and 
- F401 errors ('django.test.TestCase imported but not used'), one for each app I created, as Django generates these automatically.
I decided that the F401 errors were unimportant, as they involved only the import of a single model, again, automatically by Django, and I did not want to remove the test files, as I may do automated testing at a later stage. I also consider that it is safe to ignore the E501 errors, as this is the way Django generates the files for all projects, and they are not related to any code I've written or edited myself.

![Be-a-Dear project](documentation/flake8-be-a-dear.png)

![Volunteer app](documentation/flake8-volunteer.png)

![About app](documentation/flake8-about.png)

![Users app](documentation/flake8-users.png)

![Manage.py and env.py files](documentation/flake8-manage-env.png)

### JavaScript
The two JavaScript files I created for Be a Dear are slots.js (in the static folder of the be_a_dear project) and dashboard.js (in the static folder of the volunteer app). I ran these through JSHint and there are no errors. One comment occurs on each, however, regarding bootstrap--that it is an undefined variable. I believe that this is down to the fact that the linter cannot see what is in the rest of my project, such as the bootstrap script being loaded at the bottom of my templates. I decided that this comment was safe to ignore. The results are shown below.

![JSHint validation result for slots.js](documentation/jshint-slotsjs.png)

![JSHint validation result for dashboard.js](documentation/jshint-dashboard.png)

### CSS
The project has one CSS file, located in the static folder of the be_a_dear project. It passed the ![W3C CSS Validator](https://jigsaw.w3.org/css-validator/) with no errors.

![W3C CSS validation](documentation/CSS-validation.png)

### HTML

### Lighthouse
Lighthouse scores were good, with accessibility and SEO scoring 100 each and performance scoring 90. 
The homepage header image was highlighted by lighthouse as not having dimensions set in the html, which can slow load times, so I resized it and gave it explicit dimensions in the html, leaving the CSS style of 100% width and auto height in place. This tipped the performance score from 89 to 90, although I understand that scores can vary slightly due to changes in underlying conditions. 
Other factors affecting performance are down to things that my project relies upon, such as render-blocking resources comprising the various CDNs I employ, such as Google Fonts, FontAwesome, JSDeliver/Bootstrap, and Heroku itself.

![alt text](documentation/lighthouse-chrome.png)

### Console Message
A frequent console message in all browsers was the following:

![alt text](documentation/mixed-content-console-message.png)

This is caused by Cloudinary serving the image files over http instead of https. As I understand it, there is a way to force Cloudinary delivery of messages over https, but I have not done so here. Future enhancement of the project will address this. Although less than ideal, I felt it was safe to ignore this.  According to ![MDN Web Docs](https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content), there are two types of mixed content: "upgradable content" and "blockable content", and browsers should upgrade the upgradable content before rending a page. This is indeed what the above message shows is being done, as my mixed messages are of the first type, which is more benign than the second. When I ran the Heroku deployed app through ![Crawl Center's mixed content checker](https://www.crawlcenter.com/mixed-content-checker), as suggested by MDN Web Docs, I received the evaluation that no mixed content was found.

![Mixed Content Checker](documentation/mixed-content-checker.png)

## Manual Testing

## Global 

### Browsers
The deployed app was tested in the following browsers, with no errors or infelicities occurring. It was not possible to check IOS (iPhone) due to a known problem serving Heroku apps there.

- Chrome:
- Safari
- Microsoft Edge
- Android (Samsung Z-Flip 4)

### Navigation
#### Navigation Bar
| Feature | Action | Expected Result | Pass or Fail |
|---------|--------|-----------------|--------------------|
| Logo (with text) | click on logo | routes user to homepage (if not already there) | Pass |
| Home | click on "home" on navbar | routes user to homepage | Pass |
| About | click on "about" in navbar | routes user to About page | Pass |
| Volunteer | click on volunteer in navbar | routes user to Volunteer page (beneficiaries.html) | Pass |
| Contact Us | click on Contact Us navbar link | user is directed to about/contact_us url, which contains a form for sending a message | Pass |
| Login | user clicks on "login" on navbar | user brought to login page containing login form *(see also Authentication) | Pass |
| Register | user clicks on "register" | user is directed to accounts/signup url and presented with signup form | Pass |
| Logout | a logged in user clicks on Logout | user is brought to the logout page and the modal "are you sure" appears for confirmation | Pass |
| signout confirmation | user clicks Sign Out on confirmation modal | user is logged out | Pass |
| Navbar visible options | -- | Logged in user sees Logout, and logged out or unregistered user sees Login and Register; all else visible at all times | Pass |
#### Other links
| Feature | Action | Expected Result | Pass or Fail (P/F) |
|---------|--------|-----------------|--------------------|
| Homepage: Inline link to About page | click on link |sends the user to the About page | Pass |
| Homepage: Inline link to "message" | click on link | sends user to the Contact Us form | Pass |
| Homepage: Inline link to Volunteer page | click on link | sends user to the Volunteer page | Pass |
| Homepage: Back button from the above links | click on back button | redirected to Home page | Pass |
| Dashboard (for user with no tasks saved): message link | user clicks link | redirected to contact form | Pass |
| Dashboard (for user with no tasks saved): Volunteer link | user clicks on link | directed to volunteer page | Pass |

#### Forms
All forms function as expected. The actions and results listed below are also included in the relevant places under Navigation, Authentication, and User Stories and CRUD.
| Feature | Action | Expected Result | Pass or Fail (P/F) |
|---------|--------|-----------------|--------------------|
| Login Form ( be_a_dear templates 'account/login.html') | A registered clicks the navbar or other login link on the site  | The form accepts a username and password; if incorrect, it informs user. Links to register and send an email for forgotten password work; user can successfully log in | Pass |
| Logout |  |  | Pass |
| Register |  |  | Pass |
| Slot Form | user fills in the form for creating or updating a slot | If and only if a new slot, new object created in database, if an update, changes are reflected in the database | Pass |
| Update Slot Form
| Collaborate Form | user fills in form and clicks Send | Form sends message and user is notified of success | Pass |








### Logged in Status
| Feature | Action | Expected Result | Pass or Fail (P/F) |
|---------|--------|-----------------|--------------------|
| Logged in Status | Visit site | A logged out or unregistered user sees a message that they are not logged in | Pass |
| Logged in Status 2 | Log in | A logged in user sees a message at the top of every page that they are logged in as <username> | Pass |

### Authentication
| Feature | Action | Expected Result | Pass or Fail |
|---------|--------|-----------------|--------------|
| User login | site visitor clicks on login on navbar | user is redirected to sign-in form at accounts/login url and is able to log in | Pass |
| User logout | logged in user clicks navlink to log out | user brought to logout page and asked if they are sure, then logged out if they click sign out button | Pass |
| User account | visitor clicks on Registration in the navbar | user is directed to the sign up page and can sign up | Pass |
| No log in by unregistered user | A user without an account clicks on login | Sign in fails and user is directed to Register first | Pass |
| Registration - part 2 | user clicks on the inline Register link at login page | user brought to accounts/signup url and presented with form where they are able to register | Pass |
| Prevent non logged in user from accessing the form where they can reserve a slot | user clicks on a beneficiary from the Volunteer page | user is directed as usual to the beneficiary detail page but receives the message that they must be logged in to save a task to their dashboard, and a link to do so. The form to save a slot does not appear. | Pass |
| Student Dashboard access prevention for non-logged-in user | user types in the student_dashboard url | user is redirected to the sign-in page  | Pass |
| Privacy | -- | There is no way to access another person's dashboard, as all user-specific content is coded in templates and javascript, not via separate urls | Pass |
| Wrong password or username | A user types in the wrong password and username combination | A message appears stating that the username and/or password specified are incorrect, and the user can still try again | Pass |
| Forgotten password | User clicks on the forgotten password link | user directed to message form to send message for help, then redirected to home page | Pass |
| Admin panel access | user types in admin url | User asked to authenticate with username and password, denied access unless previously granted by superuser | Pass |
| Admin panel access 2 | user types in admin url | Users gains access, but only for those tasks / priviledges previously granted by superuser | Pass |
| Admin panel 2b | authorized teacher visits admin panel and attempts to change something not authorized | No fields that they should not be able to edit appear as editable | Pass |


## User Stories and CRUD

### General stories

[User stories and Kanban board in GitHub](https://github.com/users/ChristineEC/projects/5)

As a school member, I can create an account and sign-in so that I can participate in the project: Yes. (See [Authentication](#authentication), above).

As a registered user, I can log in and log out with ease. Yes. (See [Authentication](#authentication), above).

As a site owner, I can mark as read messages received so that I can keep track of what needs to be done or messages that need responding to.
| Feature | Action | Expected Result | Pass or Fail |
|---------|--------|-----------------|--------------|
| Messages | user sends a message from the About page or the message or Contact Us links | I can mark the messages as read (or unread) in the admin panel | Pass |

As a site owner, I can post information about an organization or other beneficiary so that visitors to the website can read about volunteer opportunties.
| Feature | Action | Expected Result | Pass or Fail |
|---------|--------|-----------------|--------------|
| Display list of beneficiaries | User visits the Volunteer page (volunteer_opportunities.html) | user sees the list of all beneficiaries marked in the admin panel as published | Pass |

As a site owner, I can post information about the project so that visitors can learn what the project is about.
| Feature | Action | Expected Result | Pass or Fail |
|---------|--------|-----------------|--------------|
| About page | user visits About page | Any user can access the About page, which is displayed in an attractive, legible manner consistent with UX principles | Pass |
| About page admin | superuser drafts content | Most recent published content appears on the about page | Pass |

As a visitor to the website, I can send a message to the site owner so that I can ask them to post a specific volunteer opportunity.
| Feature | Action | Expected Result | Pass or Fail |
|---------|--------|-----------------|--------------|
| Contact form on the about page | user enters a message and clicks on send | Message is received in the admin panel, and user stays on the About page | Pass |
| Contact Us navlink | user clicks | user directed to a Contact Form, then redirected back to homepage; message is received | Pass |
| Message links (see also [Other Links](#other-links)) | user clicks from various places on the website | directed to Contact Form then back to page they came from; message is received | Pass |

As a teacher or school administrator, I can access the admin panel so that I can review students' tasks and approve their volunteer work
| Feature | Action | Expected Result | Pass or Fail |
|---------|--------|-----------------|--------------|
| Admin access | user tries to access admin panel (when not authorized) | user asked for credentials, if not authorized by superuser gets no access | Pass |
| Admin access 2 | authorized teacher tries to change an unauthorized feature in the admin panel | is unable to access fields for editing | Pass |

### Full front-end CRUD
Student creation of slots related to beneficiaries: 
- As a student I can create specific volunteer slots (or "tasks") linked to a beneficiary so that I can reserve the slot (i.e., save to student dashboard)
- As a student I can edit my slots so that the slots accurately reflect my volunteer work
- As a student I can delete any slot that I have reserved so I can remove the expectation that I will fulfill it
- 

| Feature | Action | Expected Result | Pass or Fail |
|---------|--------|-----------------|--------------|
| Reserve a task | fill in form and click "save to dashboard" (beneficiary_detail.html template) | an object is created in the database, with the "reserved_by" attribute equal to the requesting user, and appears on that student's dashboard | Pass |
| Edit a task where created | user clicks Edit button on the page where they saved the task (beneficiary_detail.html template) | the form is prefilled, editable, and can then be saved; it updates the object in the database and shows correctly on the user's dashboard | Pass |
| Delete a task from where created | user clicks Delete button on the page where they saved the task (beneficiary_detail.html template) | Delete modal appears asking if they're sure, and if they click delete, the object is deleted from the database, and thus everywhere on the site | Pass |
| Edit slot from dashboard | user clicks on edit button next to the slot on the dashboard | user is directed to prepopulated Update Slot Form and can successfully edit the slot there then be returned to the dashboard | Pass |
Delete slot from the dashboard | user clicks on delete button next to the slot on the dashboard | a modal appears warning the user that the deletion will be permanent, with a button to proceed (or cancel); if delete is clicked there the object is successfully deleted and the user stays on the dashboard | Pass |

As a student I want to be able to record my volunteer time(s) so that I can include them in requests for credit.
| Feature | Action | Expected Result | Pass or Fail |
|---------|--------|-----------------|--------------|
| Request credit | student fills in number of minutes they are requesting credit for, or uses date and time (char) fields to enter additional days and times for the same task before requesting credit | slot is updated and teacher and student can see this clearly (student sees which slots they've requested credit for that have not yet been approved vs. those approved) | Pass |

Student dashboard: As a student I can see all of my slots on my own page so that I can keep track of my obligations and credits
| Feature | Action | Expected Result | Pass or Fail |
|---------|--------|-----------------|--------------|
| Student Dashboard | student clicks on My Dashboard (or a dashboard link--see [Other links](#other-links), above) | If the student has tasks saved, they see a table containing all slots they are signed up for, color coded by "planned", "completed", "credit requested" and "credit received". (Students with no slots see a box stating that that is where their slots will show and presenting them with a link to the volunteer page to start saving tasks.) Total time credited, total time required, and remaining time needed are summarized below the table | Pass |



## Bugs!

The default images were not being loaded for the About, Profile or Beneficiary objects.
**Fix:** Change default to "placeholder", rather than "default.jpg" or "placeholderimage.jpg", then load the relevant placeholder images conditionally in the templates.

:worried: The Slot Form (from the beneficiary detail page) was not posting correctly to the database when a user tried to edit. Although it would populate with the two first fields, it would then create a new Slot object. The reason for the bug is that I wasn't (originally) displaying all of the attributes in the rendered html template, so the javascript could not pick up all of the relevant attributes to edit. This threw errors and did not allow the javascript to run to the end of the function (where it should then change the button from "Save to Dashboard" to "Update").
**Fix:** I decided to render all of the objects attributes in the template so that they could be picked up by the javascript for editing, allowing the js function to complete, and thus allowing successful editing of the object. I considered making some of the attributes "hidden" using CSS classes, but further research revealed that javascript would not pick up any such hidden attributes. On further consideration, I thought that showing all of the attributes actually improved user experience and furthered one purpose of the project, which was to have students be able to read about what others were doing. That is, there was no harm, but to the contrary, some benefit, in rendering all of the objects attributes in the templates. As an afterthought, if I had truly wanted to hide the objects' attributes in the rendered templates, I could have simply made them display in the same font color as the background. However, I seem to recall learning that that is not good practice. So my solution in that case would be to use a different method of enabling the editing of objects, such as by using an update form, as is done from the student dashboard page. In any case, at first my solution did not work, and I discovered that I had a number of typographical errors in my javascript (in `slots.js`). Many thanks to Code Institute Tutor support for helping me identify that typo!


Errors occurred in the terminal after writing new javascript, but the errors pointed to the older javascript that had been working fine up until that point. On the student dashboard page, for which the new javascript was written, the code would not run through to complete the function relevant for that page. Those errors indicated a problem with the bootstrap delete Modal, which is used on a different page for editing slots. And on that other page, where the javascript was being used to prepopulate the form to edit a slot, an error was being thrown which referenced the javascript for the dashboard. I did not notice that second fact at first, so I was thinking that perhaps there had been some update with bootstrap that I would need to take into consideration, as the error pointed not only to my js file, but to the bootstrap script as well. But as I discussed the issue with Holly at Code Institute Tutor Support, I discovered the fact about the other webpage displaying a related (but reverse) error, and at Holly's suggestion, 
**Fix:** I split the javascript into separate files, each targeting only the relevant page or pages. Problem solved! Thank you, Holly!

Default images are not loading.

The footer is transparent except for the text, which covers content when content is scrolled.

After modifying lines of python code for the Slot model to make the lines shorter in compliance with PEP8 standards, the task-location field was being displayed on the form for updating the slot as two separate phrases with a large gap between them.
**Fix:** I removed the backslash that I had used to break the line for the string comprising the default value (on lines 55 and 56) and replaced it with ordinary quotes.

- Horizontal scrolling
**Fix** I decided to use a quick fix for this bug, as the horizontal scrolling was extremely minimal, by styling the body in CSS with overflow-x hidden.

- Last minute horror!
On what I considered the final deployed project, the delete button was not functioning on the student dashboard. I found after comparing the javascript with the html that I had accidentally deleted a class necessary for the JavaScript (written for the delete modal) to identify the button when I was restyling it for better UI. Although not a bug, at the same time I found a mislabeled aria-label ("update this task" where it should have been "delete this task" - obviously the result of a too-hurried copy and paste the failure to edit during development).
**Fix** Reinsert the necessary class for the delete button ("btn-delete-task").

Full transparency: The js file was unchanged, but I did retest, with the same passing result. I had not run the html tests yet at the time of the change.

